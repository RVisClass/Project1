<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <script src="https://d3js.org/d3.v5.min.js"></script>
  <style>
  </style>
</head>

<body>
  <chart-area></chart-area>
  <script>
    // Feel free to change or delete any of the code you see in this editor!
    var margin = { left:80, right:20, top:50, bottom:100 };
var height = 500 - margin.top - margin.bottom, 
    width = 800 - margin.left - margin.right;

var g = d3.select("chart-area")
    .append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
    .append("g")
        .attr("transform", "translate(" + margin.left + 
            ", " + margin.top + ")");

var time = 0;

// Scales
var x = d3.scaleBand()
    //.base(10)
    .range([0, width])
    .domain([0, 150000]);
    console.log(x)
var y = d3.scaleLinear()
    .range([height, 0])
    .domain([0, 14000]);
    console.log(y)
//var area = d3.scaleLinear()
    //.range([25*Math.PI, 1500*Math.PI])
    //.domain([2000, 1400000000]);
    //console.log(area)
//var continentColor = d3.scaleOrdinal(d3.schemePastel1);

// Labels
var xLabel = g.append("text")
    .attr("y", height + 50)
    .attr("x", width / 2)
    .attr("font-size", "20px")
    .attr("text-anchor", "middle")
    .text("Months");
var yLabel = g.append("text")
    .attr("transform", "rotate(-90)")
    .attr("y", -40)
    .attr("x", -170)
    .attr("font-size", "20px")
    .attr("text-anchor", "middle")
    .text("Births")
/*var timeLabel = g.append("text")
    .attr("y", height -10)
    .attr("x", width - 40)
    .attr("font-size", "40px")
    .attr("opacity", "0.4")
    .attr("text-anchor", "middle")
    .text("1800");*/

// X Axis
var xAxisCall = d3.axisBottom(x)
		//.tickFormat(function(d){ return +d; });
    .tickValues(["1"])
    //.tickFormat(d3.format("$"));
g.append("g")
    .attr("class", "x axis")
    .attr("transform", "translate(0," + height +")")
    .call(xAxisCall);

// Y Axis
var yAxisCall = d3.axisLeft(y)
    .tickFormat(function(d){ return +d; });
    
g.append("g")
    .attr("class", "y axis")
    .call(yAxisCall);//step 1
    
d3.json("births.json").then(function(data){
    console.log(data);//step 0
  data.forEach(function(d) {
            d.births = +d.births;
    d.year = +d.year;
    d.month = +d.month;
    d.date_of_month = +d.date_of_month;
        });
 //creates an array with data of births
  var birthVal = data.map(function(d) {
    return d.births;
  });
  //creates an array with month values
  var monthVal = data.map(function(d) {
    return d.month;
  });
  //creates an array with day of the month values
  var dateVal = data.map(function(d) {
    return d.date_of_month;
  });
//leap year
      // should happen four times
      // 2000, 2004, 2008, 2012
  // its 59 days away from Jan 1
  //this is for adding each similar day
 var year2 = new Array(366);
 var counter = 0;
 var leap = 4;
  var counter2 = 0;
  var i;
 for(i = 0; i < birthVal.length; i++) {
        var temp = 0;
   if(counter == 366) {
     counter = 0;
     temp = year2[counter];
     year2[counter] = temp + birthVal[i];
     counter++;
     counter2++;
     leap++;
   } else if (i == 59 || i == 1520 || i == 2981 || i == 4442) {
	   temp = year2[59];
	   year2[59] = temp + birthVal[i];
	     counter++;
	     leap = 0;       
   } else if (counter == 59) {
	   counter++;
   } else if(counter2 > 0) {
     //year2[i] = birthVal[i];
     //counter++;
     temp = year2[counter];
     year2[counter] = temp + birthVal[i];
     counter++;
   } else {
     year2[i] = birthVal[i];
     counter++;
   }
 } // end of adding each similar day
  //getting the average of each day
  var yearAvg = new Array(366);
  var j;
  for(j = 0; j < yearAvg.length; j++) {
    //temp variable for calculating days
  var tempDay = 0;
    //getting the leap year average
  if(j == 59) {
  var leapAvg = 0;
  tempDay = year2[59];
  leapAvg = tempDay/4;
  yearAvg[59] = leapAvg;
  } else { //getting averages of all other days
  var dayAvg = 0;
  tempDay = year2[j];
  dayAvg = tempDay/15;// 15 years
    yearAvg[j] = dayAvg;
  }
  }//end of getting average of all years
  var barWidth = (width / yearAvg.length);
  var bars = g.selectAll("rect")
                .data(yearAvg)
            .enter().append("rect")
            //need to flip graph
                .attr("y", function(d){
                    return y(d);
                })
                .attr("x", function(d, i){
                    return (i * 1);
                })
                .attr("width", 10)
                //this also helps flip the graph
                .attr("height", function(d){
                    return height - y(d);
                })
  							//.attr("transform", function (d, i) {
         				//var translate = [barWidth * i, 0];
         				//return "translate("+ translate +")";
                .attr("fill", function(d) {
                    return "grey";
                });
    })
    // use blockbuilder.org to test code
// you can also upload the json file onto that site
// just click the plus icon under login to upload a file
  </script>
</body>
